План статьи:
1. Приветствие
2. Проблематика
3. Какие существуют готовые решения. Их минусы
4. Наша реализация
5. Тестим
6. Итоги

Привет, чемпионы! У каждого в жизни бывало, что встаешь утром, собираешься на работу и не понимаешь, что надеть кроме домашней пижамы на первый миттинг в 9. Время сокращается, а шанс собрать классный лук уменьшается. Давайте решать эту проблему!
![[Pasted image 20240708111639.png|300]]
# Проблематика
В современном мире практически любой вопрос исчерпан либо гениями либо нейронками. Так как мы с вами не профессиональные дизайнеры, то давайте обратимся к ИИ, чтобы он решал наши проблемы. Для этого сформулируем проблему поточнее:

- На вход подаем утреннее фото и текстовое описание с каким стилем мы сегодня выйдем в люди
- На выходе получаем готовый образ (или несколько) с качественной генерацией (чтобы не было странных фоток)
>[!faq]- Например?
>![[Pasted image 20240708112255.png|300]]

# Готовые решения на рынке

## StyleDNA
![[Pasted image 20240708112557.png]]
Классное [мобильное приложение](https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://styledna.ai/&ved=2ahUKEwjRk7WVgpeHAxUmHRAIHQ6YB9AQFnoECBMQAQ&usg=AOvVaw3IF6MIugOceCviF5SYBdkV), основная идея которого "сканируете свой гардероб - мы одеваем". То есть вы добавляете свою одежду в приложение, а алгоритмы сами собирают вам луки. Также AI-стилист вам может подсказать, что вам докупить, чтобы вы еще лучше выглядели (фича не работает в России)
![[Pasted image 20240708112903.png]]
Также реализован чат-бот, с которым вы можете "проконсультироваться" по возникшим вопросам.

Плюсы:
- У вас получится реальный образ
- Проконсультируетесь с ботом, чтобы не допускать ошибок в подборе

Минусы:
- Вы не сможете "примерить" образ, так как ваш лук сохранен в виде списка, а не фотографии
- Конский ценник на возможности AI-стилиста

## Get Outfit
Данный [стартап](https://www.getoutfit.ru/ai) разработан нашими соотечественниками совместно с другим проектом из Белоруссии. Как это все чудо работает?
Вы проходите опрос, внутри которого выбираете, какой стиль вам больше симпатизирует. После этого получаете список из 5 вещей, которые вы можете купить у магазинов-партнеров
![[Pasted image 20240708114114.png]]

Плюсы:
- Выбираете стиль, который вам понравился для генерации
- Получаете готовый список, который вам надо купить для реализации
- Если не понравилось - можете вернуть деньги за услугу

Минусы:
- Чтобы получить образ надо подождать всего лишь от 5 до 24 часов. Карл, 5 часов!
- Платный сервис
- Проект работает в партнерстве с магазинами, поэтому будет выбирать вещи первостепенно из них, а не те что лучше вам подойдут
- Опять невозможность примерить

Данный сервис лучше предыдущего, но давайте решать все накопившиеся минусы и создадим своего AI-стилиста!

# Делаем все сами
![[Pasted image 20240708114543.png|300]]

Первое что приходит на ум: берем Stable Diffusion, даем ему свое фото и пишем: "переодень меня в такой-то стиль и тд". Но это решение не очень, так как могут возникнуть галлюцинации у модели и мы получим плохой результат. Так что давайте знакомиться с техникой in-painting

Inpainting модели вида text-to-image принимают на вход: изображение, маску, промпт. Особенность таких дифузионных моделей в том, что они изменяют не все изображение, а только объекты внутри маски согласно промпту
Для нас это идеальное решение, так как нам не надо перекрашивать шкаф на фоне в делевой стиль и у модели будет меньше шанс ошибиться в генерации. Для примера возьмем [SD Inpainting](https://github.com/runwayml/stable-diffusion)

То есть на вход мы подаем исходное изображение + маска:
![[Pasted image 20240708132916.png|300]]
![[Pasted image 20240708132944.png|300]]
А на выходе можем получить:
![[Pasted image 20240708133014.png]]
Качество генерации просто бомбическое! 
![[Pasted image 20240708133217.png|300]]
Плюсы:
- Знания. Реализовали классную идею
- Бесплатно. Запускаем на свое железе
- Время генерации. Один запуск буквально 20-30с
Минусы:
- Надо самому задавать точный промпт. Иначе вы получите плохой результат
- Личный запуск. Если нет личной машины, то потребуется помощь других сервисов 

# Заключение
Сегодня посмотрели на новую технологию Inpainting и применили ее на прикладном примере. Также такой подход применяется в новых фишках редакторов фото AI характера: убрать объект с фото, дорисовать область(Out-paintning) и другое. Данную идею я реализовывал на своем интенсиве, о его результатах рассказал в тг-канале, где делюсь новостями из DS и классными кейсами - присоединяйтесь. Пишите классные проекты и stay tuned, чемпионы!